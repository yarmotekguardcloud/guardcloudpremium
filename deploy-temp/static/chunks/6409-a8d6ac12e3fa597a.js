(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6409],{1150:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let a=l(5155),n=l(2115),s=l(4437);function r(e){return{default:e&&"default"in e?e.default:e}}l(6552);let i={loader:()=>Promise.resolve(r(()=>null)),loading:null,ssr:!0},o=function(e){let t={...i,...e},l=(0,n.lazy)(()=>t.loader().then(r)),o=t.loading;function d(e){let r=o?(0,a.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,d=i?n.Suspense:n.Fragment,c=t.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(l,{...e})]}):(0,a.jsx)(s.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(l,{...e})});return(0,a.jsx)(d,{...i?{fallback:r}:{},children:c})}return d.displayName="LoadableComponent",d}},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{bindSnapshot:function(){return r},createAsyncLocalStorage:function(){return s},createSnapshot:function(){return i}});let l=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw l}getStore(){}run(){throw l}exit(){throw l}enterWith(){throw l}static bind(e){return e}}let n="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function s(){return n?new n:new a}function r(e){return n?n.bind(e):a.bind(e)}function i(){return n?n.snapshot():function(e,...t){return e(...t)}}},4437:(e,t,l)=>{"use strict";function a(e){let{reason:t,children:l}=e;return l}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),l(4553)},5603:()=>{},6278:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let a=l(8140)._(l(1150));function n(e,t){var l;let n={};"function"==typeof e&&(n.loader=e);let s={...n,...t};return(0,a.default)({...s,modules:null==(l=s.loadableGenerated)?void 0:l.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6409:(e,t,l)=>{"use strict";l.d(t,{default:()=>j});var a=l(5155),n=l(2115),s=l(7909);l(5603);var r=l(2619),i=l.n(r);function o(e){let t=Date.parse(e);return Number.isNaN(t)?e:new Date(t).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function d(e){let{deviceId:t,historyPoints:l,onSelectPoint:s}=e,r=(0,n.useMemo)(()=>(null!=l?l:[]).slice().sort((e,t)=>Date.parse(t.timestampIso)-Date.parse(e.timestampIso)),[l]);if(!t)return(0,a.jsx)("div",{className:"rounded-2xl bg-slate-900/80 p-3 text-xs text-slate-300",children:"S\xe9lectionne un appareil pour afficher son historique anti-vol."});if(!r.length)return(0,a.jsxs)("div",{className:"rounded-2xl bg-slate-900/80 p-3 text-xs text-slate-300",children:["Aucun point d’historique pour les derni\xe8res 24h.",(0,a.jsx)("br",{}),"D\xe8s que le t\xe9l\xe9phone enverra des heartbeats, tu verras les positions appara\xeetre ici."]});let i=r[0].timestampIso;return(0,a.jsxs)("div",{className:"flex h-full flex-col rounded-2xl bg-slate-900/85 p-3 text-xs text-slate-100",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Historique anti-vol"}),(0,a.jsx)("div",{className:"text-[11px] text-slate-400",children:"Positions, SIM, mode avion (24h)"})]}),(0,a.jsxs)("div",{className:"rounded-full bg-slate-800 px-2 py-1 text-[11px] text-slate-300",children:["Dernier point\xa0: ",o(i)]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto rounded-2xl border border-slate-800 bg-slate-950/80",children:(0,a.jsxs)("table",{className:"min-w-full text-[11px]",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-slate-950",children:(0,a.jsxs)("tr",{className:"border-b border-slate-800 text-[10px] uppercase tracking-wide text-slate-500",children:[(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"Heure"}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"Lat / Lng"}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"Pr\xe9c."}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"Batt."}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"R\xe9seau"}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"SIM"}),(0,a.jsx)("th",{className:"px-2 py-1 text-left",children:"Avion"})]})}),(0,a.jsx)("tbody",{children:r.map((e,t)=>{let l="number"==typeof e.lat&&!Number.isNaN(e.lat)&&"number"==typeof e.lng&&!Number.isNaN(e.lng),n=l?"".concat(e.lat.toFixed(5)," / ").concat(e.lng.toFixed(5)):"N/A",r=0===t;return(0,a.jsxs)("tr",{className:"cursor-pointer border-b border-slate-900/60 transition hover:bg-slate-800/60 ".concat(r?"bg-slate-800/50":""),onClick:()=>{l&&s&&s(e)},children:[(0,a.jsx)("td",{className:"px-2 py-1 whitespace-nowrap",children:o(e.timestampIso)}),(0,a.jsx)("td",{className:"px-2 py-1 font-mono text-[10px]",children:n}),(0,a.jsx)("td",{className:"px-2 py-1",children:"number"==typeof e.accuracy_m?"\xb1".concat(Math.round(e.accuracy_m),"m"):"N/A"}),(0,a.jsx)("td",{className:"px-2 py-1",children:null!=e.battery?"".concat(e.battery,"%"):"N/A"}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.networkType||"?"}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.simChanged?(0,a.jsx)("span",{className:"rounded-full bg-rose-600/30 px-2 py-0.5 text-[10px] text-rose-100",children:"chang\xe9e"}):(0,a.jsx)("span",{className:"text-slate-400 text-[10px]",children:"OK"})}),(0,a.jsx)("td",{className:"px-2 py-1",children:e.airplaneMode?(0,a.jsx)("span",{className:"rounded-full bg-amber-500/20 px-2 py-0.5 text-[10px] text-amber-200",children:"activ\xe9"}):(0,a.jsx)("span",{className:"text-slate-400 text-[10px]",children:"off"})})]},"".concat(e.timestampIso,"-").concat(t))})})]})}),(0,a.jsx)("div",{className:"mt-2 text-[10px] text-slate-500",children:"\uD83D\uDCA1 Astuce : clique sur une ligne pour d\xe9placer le marqueur sur la carte \xe0 cette position exacte."})]})}let c=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),u=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),x=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.Marker),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),m=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.Popup),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),p=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.Polyline),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),h=(0,s.default)(()=>Promise.all([l.e(1761),l.e(3538)]).then(l.bind(l,3538)).then(e=>e.Circle),{loadableGenerated:{webpack:()=>[3538]},ssr:!1}),b=null;function f(e){if("number"==typeof e&&!Number.isNaN(e))return e;if("string"==typeof e){let t=parseFloat(e);return Number.isNaN(t)?null:t}return null}function v(e){return"number"==typeof e.lat&&"number"==typeof e.lng&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)}function g(e){let t=10,l=Date.parse(e.lastHeartbeat),a=!Number.isNaN(l)&&l?Math.round((Date.now()-l)/6e4):null;e.online||(t+=40),e.simChangedRecently&&(t+=30),e.airplaneMode&&(t+=20),null!=a&&a>10&&(t+=15),null!=e.battery&&e.battery<20&&(t+=10);let n="NORMAL";return(t=Math.min(t,100))>=80?n="CRITICAL":t>=50?n="HIGH":t>=25&&(n="MODERATE"),{score:t,level:n}}function y(e,t){if(!e||!b)return;let l=t.filter(v).map(e=>[e.lat,e.lng]);if(0!==l.length){if(1===l.length)return void e.setView(l[0],Math.max(e.getZoom(),15));e.fitBounds(b.latLngBounds(l),{padding:[40,40]})}}function N(e,t,l){var a;if(!e||!t||!v(t))return;let n=[t.lat,t.lng],s=null!=(a=null==l?void 0:l.zoom)?a:Math.max(e.getZoom(),15);(null==l?void 0:l.smooth)===!1?e.setView(n,s):e.flyTo(n,s,{duration:.4})}function j(e){var t;let{initialRole:s="SUPER_ADMIN"}=e,[r,o]=(0,n.useState)([]),[j,I]=(0,n.useState)(!1),[S,E]=(0,n.useState)(null),[C,k]=(0,n.useState)(null),[D,L]=(0,n.useState)("LIVE"),[O,A]=(0,n.useState)(""),[M,_]=(0,n.useState)(!1),[P,T]=(0,n.useState)("PLAN"),[R,H]=(0,n.useState)(s),[G,z]=(0,n.useState)([]),[F,Z]=(0,n.useState)(!1),[U,q]=(0,n.useState)(null),[V,B]=(0,n.useState)(!1),[K,W]=(0,n.useState)(0),Y=(0,n.useRef)(null),[J,Q]=(0,n.useState)(0);(0,n.useEffect)(()=>{let e=!1;return(async()=>{var t,a,n;if(b)return;let s=await l.e(1761).then(l.t.bind(l,5027,23));if(e)return;b=s;let[{default:r},{default:i},{default:o}]=await Promise.all([l.e(8088).then(l.bind(l,8088)),l.e(6945).then(l.bind(l,6945)),l.e(9750).then(l.bind(l,9750))]);delete s.Icon.Default.prototype._getIconUrl,s.Icon.Default.mergeOptions({iconRetinaUrl:null!=(t=r.src)?t:r,iconUrl:null!=(a=i.src)?a:i,shadowUrl:null!=(n=o.src)?n:o})})(),()=>{e=!0}},[]),(0,n.useEffect)(()=>{let e,t=!1,l=async()=>{var e,l,a,n,s;try{I(!0),k(null);let s=await fetch("/api/admin/devices",{method:"GET",cache:"no-store"}),r=await s.json();if(!s.ok)throw Error(null!=(e=null==r?void 0:r.error)?e:"Erreur API devices (HTTP ".concat(s.status,")"));if(!1===r.ok)throw Error(null!=(l=r.error)?l:"L’API devices a retourn\xe9 une erreur.");let i=null!=(n=null!=(a=r.items)?a:r.devices)?n:[],d=(null!=i?i:[]).map(e=>(function(e){var t,l,a,n,s,r,i,o,d,c,u,x,m,p,h,b,v,g,y,N,j,w,I,S,E,C,k,D,L,O,A,M,_,P,T,R,H,G,z,F,Z,U;let q=null!=(p=null!=(m=null!=(x=f(e.lat))?x:f(e.latitude))?m:f(null==(t=e.location)?void 0:t.lat))?p:f(null==(l=e.lastLocation)?void 0:l.lat),V=null!=(v=null!=(b=null!=(h=f(e.lng))?h:f(e.longitude))?b:f(null==(a=e.location)?void 0:a.lng))?v:f(null==(n=e.lastLocation)?void 0:n.lng),B="boolean"==typeof e.online?e.online:"ONLINE"===e.status||"online"===e.status,K=e.lastHeartbeat||e.timestampIso||e.updatedAt||e.createdAt,W="string"==typeof K&&K.length>0?K:new Date().toISOString();return{id:String(e.id||e.deviceId||e.clientId||"UNKNOWN"),deviceId:String(e.deviceId||e.id||"UNKNOWN"),name:String(e.name||e.clientName||e.deviceId||"Device"),category:String(e.category||e.deviceType||"PHONE"),type:String(e.type||e.deviceType||"PHONE"),deviceType:String(e.deviceType||e.type||"PHONE"),lat:q,lng:V,accuracy_m:null!=(j=null!=(N=null!=(y=null!=(g=f(e.accuracy_m))?g:f(e.accuracy))?y:f(null==(s=e.location)?void 0:s.accuracyM))?N:f(null==(r=e.lastLocation)?void 0:r.accuracy_m))?j:null,status:B?"ONLINE":"OFFLINE",online:B,lastHeartbeat:W,battery:null!=(I=null!=(w=f(e.battery))?w:f(e.batteryLevel))?I:null,networkType:null!=(S=e.networkType)?S:null,clientId:null!=(E=e.clientId)?E:null,clientName:null!=(C=e.clientName)?C:null,clientPhone:null!=(k=e.clientPhone)?k:null,simOperator:null!=(L=null!=(D=e.simOperator)?D:null==(i=e.simInfo)?void 0:i.simOperator)?L:null,simCountry:null!=(A=null!=(O=e.simCountry)?O:null==(o=e.simInfo)?void 0:o.simCountry)?A:null,simSerialLast4:null!=(_=null!=(M=e.simSerialLast4)?M:null==(d=e.simInfo)?void 0:d.simSerialLast4)?_:null,simChangedRecently:null!=(R=null!=(T=null!=(P=e.simChangedRecently)?P:e.simChanged)?T:null==(c=e.simInfo)?void 0:c.simChanged)&&R,airplaneMode:null!=(G=null!=(H=e.airplaneMode)?H:null==(u=e.deviceFlags)?void 0:u.airplaneMode)&&G,currentZoneId:null!=(z=e.currentZoneId)?z:null,lastZoneEvent:null!=(F=e.lastZoneEvent)?F:null,resellerId:null!=(Z=e.resellerId)?Z:null,resellerName:null!=(U=e.resellerName)?U:null}})(e));if(!t){let e=Date.now(),t=d.filter(t=>{let l=Date.parse(t.lastHeartbeat);return!(!l||Number.isNaN(l))&&e-l<=1728e5});o(t),E(e=>!e&&t.length>0?t[0].deviceId:e&&!t.some(t=>t.deviceId===e)?t.length>0?t[0].deviceId:null:e)}}catch(e){t||k(null!=(s=null==e?void 0:e.message)?s:"Erreur lors du chargement des devices.")}finally{t||I(!1)}};return l(),e=window.setInterval(l,15e3),()=>{t=!0,e&&window.clearInterval(e)}},[]),(0,n.useEffect)(()=>{let e;if(!S){z([]),q(null),B(!1),W(0);return}let t=!1,l=async()=>{try{var e;Z(!0);let l=new Date(Date.now()-864e5).toISOString(),a="".concat("/api/admin/device-history","?deviceId=").concat(encodeURIComponent(S),"&since=").concat(encodeURIComponent(l)),n=await fetch(a,{method:"GET",cache:"no-store"}),s=await n.json();if(!(null==s?void 0:s.ok)){t||(z([]),q(null),B(!1),W(0));return}let r=null!=(e=s.items)?e:[];t||(z(r),B(!1),W(0))}catch(e){t||(z([]),q(null),B(!1),W(0))}finally{t||Z(!1)}};return l(),e=window.setInterval(l,6e4),()=>{t=!0,e&&window.clearInterval(e)}},[S]);let X=(0,n.useMemo)(()=>{var e;return null!=(e=r.find(e=>e.deviceId===S))?e:null},[r,S]),$=(0,n.useMemo)(()=>{if("SUPER_ADMIN"===R||!X)return r;if("CLIENT"===R){let e=X.clientId;return e?r.filter(t=>t.clientId===e):r}if("RESELLER"===R){let e=X.resellerId;return e?r.filter(t=>t.resellerId===e):r}return r},[r,R,X]),ee=(0,n.useMemo)(()=>$.filter(v),[$]),et=$.length-ee.length,el=(0,n.useMemo)(()=>{let e=O.trim().toLowerCase();return e?$.filter(t=>[t.name,t.clientName,t.clientId,t.clientPhone,t.deviceId].filter(Boolean).some(t=>String(t).toLowerCase().includes(e))):$},[$,O]),ea=(0,n.useMemo)(()=>{if(!O.trim())return ee;let e=new Set(el.filter(v).map(e=>e.deviceId));return[...ee.filter(t=>e.has(t.deviceId)),...X&&v(X)&&!e.has(X.deviceId)?[X]:[]]},[ee,el,X,O]),en=(0,n.useMemo)(()=>{if(X&&v(X))return[X.lat,X.lng];let e=ee[0];return e?[e.lat,e.lng]:[12.35,-1.52]},[X,ee]),es=(0,n.useMemo)(()=>(null==G?void 0:G.length)?[...G].sort((e,t)=>new Date(e.timestampIso).getTime()-new Date(t.timestampIso).getTime()):[],[G]),er=(0,n.useMemo)(()=>es.length?es.filter(v).map(e=>[e.lat,e.lng]):[],[es]),ei=$.filter(e=>e.online).length,eo=O.trim().length>0;(0,n.useEffect)(()=>{if(!V||0===es.length)return;let e=window.setInterval(()=>{W(e=>{let t=(e+1)%Math.max(es.length,1),l=es[t];return l&&q(l),t})},1200);return()=>window.clearInterval(e)},[V,es]),(0,n.useEffect)(()=>{let e=Y.current;e&&U&&v(U)&&e.flyTo([U.lat,U.lng],Math.max(e.getZoom(),17),{duration:.6})},[U]),(0,n.useEffect)(()=>{var e;let t=Y.current;if(!t||U)return;let l=null!=(e=r.find(e=>e.deviceId===S))?e:null;l&&v(l)?N(t,l,{zoom:M?17:15,smooth:!0}):ee.length>0&&y(t,ee)},[S,r,M,U,ee]),(0,n.useEffect)(()=>{let e=Y.current;if(!e)return;let t=window.setTimeout(()=>{var t;e.invalidateSize();let l=null!=(t=r.find(e=>e.deviceId===S))?t:null;l&&v(l)?N(e,l,{zoom:M?17:15,smooth:!0}):ee.length>0&&y(e,ee)},180);return()=>window.clearTimeout(t)},[M,r,S,ee]);let ed=M?"relative flex min-h-0 flex-1 rounded-2xl border-2 border-emerald-500/80 bg-slate-950/95 shadow-[0_32px_80px_rgba(0,0,0,0.95)]":"relative flex min-h-0 flex-1 rounded-2xl border border-slate-800 bg-slate-950/80 shadow-[0_20px_45px_rgba(0,0,0,0.7)]",ec="SUPER_ADMIN"===R?"Admin":"RESELLER"===R?"Revendeurs":"Clients",eu=es[Math.min(K,Math.max(es.length-1,0))];return(0,a.jsxs)("div",{className:"relative flex h-[calc(100vh-80px)] flex-col gap-4 bg-slate-950/95 px-4 pb-4 pt-2 text-slate-100",children:[(0,a.jsxs)("div",{className:"relative z-40 flex items-center justify-between gap-3 rounded-2xl border border-slate-800 bg-gradient-to-r from-slate-950 via-slate-900 to-slate-950 px-4 py-3 shadow-lg shadow-black/40",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-xl font-semibold tracking-tight",children:["Yarmotek GuardCloud • ",(0,a.jsx)("span",{className:"text-emerald-400",children:"Command Center"})]}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Poursuite en temps quasi r\xe9el des smartphones SahelGuard : localisation, g\xe9ofencing, commandes antivol et diagnostics avanc\xe9s."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-end gap-2 text-xs",children:[(0,a.jsx)(i(),{href:"/reseller/tokens",className:"rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-xs text-slate-200 hover:border-emerald-400",children:"Espace revendeur"}),(0,a.jsx)(i(),{href:"/client/activate",className:"rounded-full border border-emerald-500/60 bg-emerald-500/10 px-3 py-1 text-xs text-emerald-100 hover:bg-emerald-500/20",children:"Activer une licence"}),(0,a.jsx)(i(),{href:"/admin/tokens",className:"rounded-full border border-sky-500/70 bg-sky-500/10 px-3 py-1 text-xs text-sky-100 hover:bg-sky-500/20",children:"Gestion tokens (Admin)"}),(0,a.jsxs)("div",{className:"rounded-full bg-slate-900 px-3 py-1",children:[(0,a.jsx)("span",{className:"mr-2 inline-flex h-2 w-2 rounded-full ".concat(j?"bg-amber-400":"bg-emerald-400")}),j?"Mise \xe0 jour…":"Live connect\xe9"]}),(0,a.jsxs)("div",{className:"rounded-full bg-slate-900 px-3 py-1",children:["Devices r\xe9cents (48h)\xa0: ",(0,a.jsx)("span",{className:"font-semibold",children:$.length})]}),(0,a.jsxs)("div",{className:"rounded-full bg-slate-900 px-3 py-1",children:["En ligne\xa0: ",(0,a.jsx)("span",{className:"font-semibold text-emerald-400",children:ei})]}),(0,a.jsxs)("div",{className:"rounded-full bg-slate-900 px-3 py-1",children:["Localis\xe9s sur carte\xa0:"," ",(0,a.jsx)("span",{className:"font-semibold",children:ee.length})]}),et>0&&(0,a.jsxs)("div",{className:"rounded-full border border-amber-400/50 bg-amber-500/10 px-3 py-1 text-amber-200",children:[et," appareil(s) sans position (API)"]}),(0,a.jsx)("div",{className:"flex items-center rounded-full bg-slate-900 px-1 py-1 text-[11px]",children:["SUPER_ADMIN","RESELLER","CLIENT"].map(e=>{let t="SUPER_ADMIN"===e?"Admin":"RESELLER"===e?"Revendeurs":"Clients",l=R===e;return(0,a.jsx)("button",{type:"button",onClick:()=>H(e),className:"rounded-full px-2 py-0.5 transition ".concat(l?"bg-emerald-500/20 text-emerald-200":"text-slate-400 hover:text-emerald-200"),children:t},e)})}),(0,a.jsxs)("div",{className:"flex items-center rounded-full bg-slate-900 px-1 py-1 text-[11px]",children:[(0,a.jsx)("button",{type:"button",onClick:()=>T("PLAN"),className:"rounded-full px-2 py-0.5 transition ".concat("PLAN"===P?"bg-slate-800 text-slate-50":"text-slate-400 hover:text-slate-100"),children:"Plan"}),(0,a.jsx)("button",{type:"button",onClick:()=>T("SATELLITE"),className:"rounded-full px-2 py-0.5 transition ".concat("SATELLITE"===P?"bg-slate-800 text-slate-50":"text-slate-400 hover:text-slate-100"),children:"Satellite"})]}),(0,a.jsx)("button",{type:"button",disabled:!X,onClick:()=>{_(e=>!e),Q(e=>e+1)},className:"rounded-full px-3 py-1 text-xs font-medium transition ".concat(M?"border border-emerald-500/70 bg-emerald-500/10 text-emerald-200":"border border-slate-700 bg-slate-900 text-slate-200 hover:border-emerald-400"," disabled:opacity-40"),children:M?"Quitter vue Focus":"Vue Focus device"})]})]}),(0,a.jsxs)("div",{className:"relative z-40 flex min-h-0 flex-1 gap-4",children:[(0,a.jsxs)("div",{className:"flex w-72 flex-col gap-2 rounded-2xl border border-slate-800 bg-slate-950/80 p-3 text-xs shadow-[0_18px_40px_rgba(0,0,0,0.55)] ".concat(M?"hidden":""),children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-400",children:["Appareils (48h) • ",ec]}),(0,a.jsx)("span",{className:"rounded-full bg-slate-900 px-2 py-0.5 text-[10px] text-slate-400",children:"S\xe9lectionne pour piloter"})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("input",{type:"text",value:O,onChange:e=>A(e.target.value),placeholder:"Filtrer par nom, client ou ID…",className:"w-full rounded-full border border-slate-700 bg-slate-900/80 px-3 py-1.5 text-[11px] text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none"}),eo&&(0,a.jsxs)("div",{className:"mt-1 flex items-center justify-between text-[10px] text-slate-500",children:[(0,a.jsxs)("span",{children:[el.length," appareil(s) trouv\xe9(s)"]}),(0,a.jsx)("button",{type:"button",onClick:()=>A(""),className:"text-emerald-400 hover:underline",children:"R\xe9initialiser"})]})]}),(0,a.jsxs)("div",{className:"max-h-full flex-1 overflow-y-auto pr-1",children:[el.map(e=>{let t=e.deviceId===S,l=Date.parse(e.lastHeartbeat),n=!Number.isNaN(l)&&l?Math.round((Date.now()-l)/6e4):null,s=null!=n&&n>=0?0===n?"\xe0 l’instant":"il y a ".concat(n," min"):"",r=v(e);return(0,a.jsxs)("button",{type:"button",onClick:()=>{E(e.deviceId),q(null),B(!1),W(0);let t=Y.current;t&&r&&N(t,e,{zoom:M?17:15,smooth:!0})},className:"mb-2 w-full rounded-xl border px-3 py-2 text-left shadow-sm transition ".concat(t?"border-emerald-400 bg-gradient-to-r from-emerald-500/15 via-emerald-500/5 to-slate-900":"border-slate-800 bg-slate-900/60 hover:border-emerald-500/60 hover:bg-slate-900"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-[13px] font-semibold",children:e.name||e.deviceId.slice(-6)}),(0,a.jsx)("span",{className:"text-[10px] text-slate-400",children:e.clientName||"Client N/A"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] ".concat(e.online?"bg-emerald-500/10 text-emerald-300":"bg-slate-800 text-slate-400"),children:[(0,a.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(e.online?"bg-emerald-400":"bg-slate-500")}),e.online?"Online":"Offline"]}),s&&(0,a.jsx)("span",{className:"text-[9px] text-slate-500",children:s})]})]}),(0,a.jsxs)("div",{className:"mt-1 flex items-center justify-between text-[10px] text-slate-500",children:[(0,a.jsxs)("span",{children:[e.category,!r&&" \xb7 pas de position"]}),(0,a.jsx)("span",{children:null!=e.battery?"".concat(e.battery,"%"):"Batterie N/A"})]})]},e.deviceId)}),0===el.length&&!j&&(0,a.jsxs)("div",{className:"mt-4 rounded-xl bg-slate-900/70 p-3 text-xs text-slate-400",children:["Aucun appareil ne correspond au filtre.",(0,a.jsx)("br",{}),"Modifie le texte ou r\xe9initialise le filtre."]}),0===$.length&&!j&&!eo&&(0,a.jsxs)("div",{className:"mt-4 rounded-xl bg-slate-900/70 p-3 text-xs text-slate-400",children:["Aucun device r\xe9cent dans cette vue (",ec,"). Envoie un heartbeat depuis SahelGuard (dans les 48 derni\xe8res heures) pour le voir appara\xeetre ici."]})]})]}),(0,a.jsxs)("div",{className:"flex min-h-0 flex-1 gap-4",children:[(0,a.jsxs)("div",{className:ed,children:[(0,a.jsxs)(c,{center:en,zoom:15,className:"h-full w-full rounded-2xl",scrollWheelZoom:!0,ref:e=>{Y.current=e},whenReady:()=>{let e=Y.current;e&&setTimeout(()=>e.invalidateSize(),50)},children:[(0,a.jsx)(u,{attribution:"PLAN"===P?"&copy; OpenStreetMap contributors":"Tiles \xa9 Esri — Source: Esri, Maxar, Earthstar Geographics, and the GIS User Community",url:"PLAN"===P?"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png":"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}),er.length>1&&(0,a.jsx)(p,{positions:er}),(M&&X&&v(X)?[X]:ea).filter(v).map(e=>{let t=(null==X?void 0:X.deviceId)===e.deviceId,l=function(e,t,l){if(!b)return;let{level:a}=g(e),n="#22c55e",s="rgba(34,197,94,0.45)";"CRITICAL"===a?(n="#ef4444",s="rgba(239,68,68,0.6)"):"HIGH"===a?(n="#f59e0b",s="rgba(245,158,11,0.55)"):e.online||(n="#64748b",s="rgba(148,163,184,0.4)");let r=t||l?"#22c55e":"#0f172a",i=t||l?40:30,o='\n    <div style="position:relative;width:'.concat(i,"px;height:").concat(i,'px;display:flex;align-items:center;justify-content:center;transform:translateY(-6px);">\n      <div style="position:absolute;width:').concat(i,"px;height:").concat(i,"px;border-radius:999px;background:").concat(s,";box-shadow:0 0 18px ").concat(s,";opacity:").concat(e.online?"1":"0.85",';"></div>\n      <div style="position:relative;width:').concat(i-10,"px;height:").concat(i-10,"px;border-radius:999px;background:#020617;border:2px solid ").concat(r,";box-shadow:0 8px 18px rgba(0,0,0,0.75);display:flex;align-items:center;justify-content:center;color:").concat(n,';font-size:11px;font-weight:600;">\n        ').concat((e.category||"P").slice(0,1),"\n      </div>\n    </div>\n  ");return b.divIcon({className:"yarmotek-device-marker",html:o,iconSize:[i,i],iconAnchor:[i/2,i]})}(e,t,M);return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(x,{position:[e.lat,e.lng],icon:l,eventHandlers:{click:()=>{E(e.deviceId),q(null),B(!1),W(0);let t=Y.current;t&&N(t,e,{zoom:M?17:15,smooth:!0})}},children:(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.name||e.deviceId}),(0,a.jsx)("div",{className:"text-slate-500",children:e.clientName||"Client N/A"}),(0,a.jsxs)("div",{className:"mt-1",children:["Dernier heartbeat : ",new Date(e.lastHeartbeat).toLocaleString()]}),null!=e.battery&&(0,a.jsxs)("div",{children:["Batterie : ",e.battery,"%"]}),(0,a.jsxs)("div",{children:["R\xe9seau : ",e.networkType||"?"]})]})})}),"number"==typeof e.accuracy_m&&e.accuracy_m>0&&(0,a.jsx)(h,{center:[e.lat,e.lng],radius:e.accuracy_m,pathOptions:{color:"rgba(56,189,248,0.8)",fillColor:"rgba(56,189,248,0.18)",fillOpacity:.18,weight:1}})]},e.deviceId)}),U&&v(U)&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(x,{position:[U.lat,U.lng],children:(0,a.jsx)(m,{children:(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Position historique"}),(0,a.jsx)("div",{children:new Date(U.timestampIso).toLocaleString()}),"number"==typeof U.accuracy_m&&(0,a.jsxs)("div",{children:["Pr\xe9cision\xa0: \xb1",Math.round(U.accuracy_m)," m"]})]})})}),"number"==typeof U.accuracy_m&&U.accuracy_m>0&&(0,a.jsx)(h,{center:[U.lat,U.lng],radius:U.accuracy_m,pathOptions:{color:"rgba(251,191,36,0.9)",fillColor:"rgba(251,191,36,0.22)",fillOpacity:.22,weight:1}})]})]},J),(0,a.jsxs)("div",{className:"pointer-events-none absolute left-3 top-3 z-50 flex flex-col gap-2 text-[11px]",children:[(0,a.jsxs)("div",{className:"pointer-events-auto inline-flex items-center gap-3 rounded-full bg-slate-900/90 px-4 py-1 shadow-lg shadow-black/40",children:[(0,a.jsxs)("span",{className:"font-semibold text-emerald-300",children:["Phones SahelGuard : ",$.length]}),(0,a.jsxs)("span",{className:"text-slate-300",children:["En ligne : ",(0,a.jsx)("span",{className:"font-semibold text-emerald-400",children:ei})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e=Y.current;e&&y(e,ee)},className:"rounded-full bg-emerald-500/10 px-3 py-0.5 text-[11px] font-medium text-emerald-100 hover:bg-emerald-500/20",children:"Rafra\xeechir vue"})]}),F&&(0,a.jsx)("div",{className:"pointer-events-auto inline-flex rounded-full bg-slate-900/85 px-3 py-1 text-[11px] text-slate-200 shadow-md shadow-black/30",children:"Mise \xe0 jour du trajet…"})]}),M&&X&&(0,a.jsxs)("div",{className:"pointer-events-none absolute left-1/2 top-3 z-40 -translate-x-1/2 rounded-full bg-emerald-600/25 px-4 py-1 text-[11px] text-emerald-100 backdrop-blur",children:["\uD83C\uDFAF Mode poursuite : ",(0,a.jsx)("span",{className:"font-semibold",children:X.name||X.deviceId})]}),es.length>1&&(0,a.jsxs)("div",{className:"pointer-events-none absolute bottom-3 left-3 z-50 flex items-center gap-3 rounded-full bg-slate-900/90 px-4 py-2 text-[11px] text-slate-100 shadow-lg shadow-black/40",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{let e=!V;B(e),e&&es.length>0&&(W(0),q(es[0]))},className:"pointer-events-auto rounded-full bg-slate-800 px-3 py-1 text-xs font-semibold hover:bg-slate-700",children:V?"⏸ Pause trajet":"▶ Rejouer trajet"}),(0,a.jsxs)("div",{className:"pointer-events-none flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-1 w-32 overflow-hidden rounded-full bg-slate-700/70",children:(0,a.jsx)("div",{className:"h-full bg-emerald-400",style:{width:"".concat(es.length>0?Math.round((K+1)/es.length*100):0,"%")}})}),eu&&(0,a.jsx)("span",{className:"text-[10px] text-slate-300",children:new Date(eu.timestampIso).toLocaleTimeString()})]})]}),X&&v(X)&&(0,a.jsx)("div",{className:"pointer-events-none absolute bottom-3 right-3 z-50",children:(0,a.jsxs)("button",{type:"button",onClick:()=>{let e=Y.current;e&&N(e,X,{zoom:M?17:15,smooth:!0})},className:"pointer-events-auto rounded-full bg-slate-900/90 px-3 py-1.5 text-[11px] text-slate-100 shadow-lg shadow-black/40 hover:bg-slate-800",children:["\uD83C\uDFAF Centrer sur ",(0,a.jsx)("span",{className:"font-semibold",children:X.name||X.deviceId.slice(-6)})]})})]}),(0,a.jsxs)("div",{className:"flex w-[420px] flex-col gap-2 rounded-2xl border border-slate-800 bg-slate-950/80 p-3 text-xs shadow-[0_20px_45px_rgba(0,0,0,0.7)] ".concat(M?"hidden":""),children:[(0,a.jsxs)("div",{className:"mb-2 flex rounded-full bg-slate-900/80 p-1 text-[11px]",children:[(0,a.jsx)("button",{type:"button",className:"flex-1 rounded-full px-2 py-1 transition ".concat("LIVE"===D?"bg-gradient-to-r from-slate-800 via-slate-900 to-slate-800 text-slate-50":"text-slate-400"),onClick:()=>L("LIVE"),children:"Vue en direct"}),(0,a.jsx)("button",{type:"button",className:"flex-1 rounded-full px-2 py-1 transition ".concat("HISTORY"===D?"bg-gradient-to-r from-slate-800 via-slate-900 to-slate-800 text-slate-50":"text-slate-400"),onClick:()=>L("HISTORY"),children:"Historique"})]}),"LIVE"===D&&(0,a.jsx)(w,{device:X,error:C}),"HISTORY"===D&&(0,a.jsx)(d,{deviceId:null!=(t=null==X?void 0:X.deviceId)?t:null,historyPoints:es,onSelectPoint:e=>{q(e),B(!1);let t=es.findIndex(t=>t.timestampIso===e.timestampIso);t>=0&&W(t)}})]})]})]})]})}function w(e){let{device:t,error:l}=e,[s,r]=(0,n.useState)(null),[i,o]=(0,n.useState)(null),[d,c]=(0,n.useState)([]),u=e=>{c(t=>[e,...t].slice(0,6))};if(!t)return(0,a.jsx)("div",{className:"rounded-2xl bg-slate-900/80 p-3 text-xs text-slate-300",children:"S\xe9lectionne un appareil dans la liste pour voir son statut en temps r\xe9el et envoyer des commandes anti-vol SahelGuard."});let x=Date.parse(t.lastHeartbeat),m=!Number.isNaN(x)&&x?Math.round((Date.now()-x)/6e4):null,{score:p,level:h}=g(t),b=async e=>{try{r(e),o(null);let l=await fetch("/api/admin/commands",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify({deviceId:t.deviceId,action:e,durationSec:20*("RING"===e)})}),a=await l.json();if(!l.ok||!a.ok)throw Error(a.error||"Commande refus\xe9e (HTTP ".concat(l.status,")"));let n="",s="";switch(e){case"RING":n="✅ Sonnerie envoy\xe9e au t\xe9l\xe9phone (20s).",s="Faire sonner 20s";break;case"LOST_MODE":n="✅ Mode perdu / vol\xe9 activ\xe9. Le message d’alerte s’affichera sur le t\xe9l\xe9phone.",s="Mode perdu / vol\xe9";break;case"LOCK":n="✅ Commande de verrouillage envoy\xe9e. Le t\xe9l\xe9phone se bloquera au prochain heartbeat.",s="Verrouillage \xe9cran (PIN admin)";break;case"LOCATION_ONCE":n="✅ Demande de localisation instantan\xe9e envoy\xe9e. La carte va se mettre \xe0 jour au prochain heartbeat.",s="Localiser maintenant";break;case"LOCATION_STREAM":n="✅ Suivi intensif activ\xe9. Le t\xe9l\xe9phone enverra des positions r\xe9guli\xe8res pendant l’alerte.",s="Suivi intensif"}o(n);let i={id:"".concat(Date.now(),"-").concat(e),action:e,label:s,at:new Date().toLocaleTimeString(),status:"OK"};u(i)}catch(t){var l;o("❌ Erreur envoi commande : ".concat(null!=(l=null==t?void 0:t.message)?l:"erreur inconnue")),u({id:"".concat(Date.now(),"-").concat(e),action:e,label:e,at:new Date().toLocaleTimeString(),status:"ERROR",details:null==t?void 0:t.message})}finally{r(null)}},f=!t.online;return(0,a.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl bg-slate-900/85 p-3 text-xs text-slate-100",children:[l&&(0,a.jsx)("div",{className:"rounded-xl bg-red-950/60 p-2 text-[11px] text-red-200",children:l}),(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"SAHELGuard • Antivol"}),(0,a.jsx)("div",{className:"text-sm font-semibold",children:t.name||t.deviceId}),(0,a.jsxs)("div",{className:"text-[11px] text-slate-400",children:[t.clientName||"Client N/A"," \xb7 ID device : ",t.deviceId.slice(-8)]})]}),(0,a.jsxs)("div",{className:"rounded-xl border bg-gradient-to-br px-3 py-2 text-right text-[11px] ".concat("CRITICAL"===h?"from-red-500/30 to-red-600/20 border-red-500/70":"HIGH"===h?"from-amber-500/30 to-amber-600/20 border-amber-400/70":"MODERATE"===h?"from-emerald-500/20 to-emerald-600/10 border-emerald-400/70":"from-emerald-500/15 to-emerald-600/5 border-emerald-300/60"),children:[(0,a.jsx)("div",{className:"text-[10px] uppercase tracking-wide text-slate-200",children:"Niveau de risque"}),(0,a.jsx)("div",{className:"text-xs font-semibold",children:"CRITICAL"===h?"Critique":"HIGH"===h?"\xc9lev\xe9":"MODERATE"===h?"Mod\xe9r\xe9":"Normal"}),(0,a.jsxs)("div",{className:"text-[10px] text-slate-200/80",children:["Score\xa0: ",p,"/100"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(I,{label:"Statut",value:t.online?"En ligne":"Hors ligne",accent:t.online?"emerald":"slate"}),(0,a.jsx)(I,{label:"Dernier heartbeat",value:null==m?new Date(t.lastHeartbeat).toLocaleTimeString():0===m?"\xe0 l’instant":"il y a ".concat(m," min")}),(0,a.jsx)(I,{label:"Batterie",value:null!=t.battery?"".concat(t.battery,"%"):"N/A"}),(0,a.jsx)(I,{label:"R\xe9seau",value:t.networkType||"N/A"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(I,{label:"SIM op\xe9rateur",value:t.simOperator||"N/A"}),(0,a.jsx)(I,{label:"Pays SIM",value:t.simCountry||"N/A"}),(0,a.jsx)(I,{label:"SIM chang\xe9e",value:t.simChangedRecently?"OUI":"Non"}),(0,a.jsx)(I,{label:"Mode avion",value:t.airplaneMode?"Activ\xe9":"D\xe9sactiv\xe9"})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-950/70 px-3 py-2",children:[(0,a.jsx)("div",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"G\xe9ofencing"}),(0,a.jsx)("div",{className:"text-xs text-slate-100",children:t.currentZoneId?"Zone actuelle : ".concat(t.currentZoneId):"Zone actuelle : hors zone"}),t.lastZoneEvent&&(0,a.jsxs)("div",{className:"text-[11px] text-slate-400",children:["Dernier \xe9v\xe8nement : ",t.lastZoneEvent.type," ",t.lastZoneEvent.zoneId," \xb7"," ",new Date(t.lastZoneEvent.timestampIso).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"mt-1 flex flex-col gap-2",children:[(0,a.jsx)("div",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"Commandes anti-vol"}),(0,a.jsxs)("button",{type:"button",onClick:()=>void b("RING"),disabled:null!==s||f,className:"flex items-center justify-between gap-2 rounded-2xl border border-amber-400/70 bg-gradient-to-r from-amber-500/15 via-amber-500/5 to-slate-900 px-4 py-2 text-sm font-semibold text-amber-100 shadow-md shadow-amber-900/30 hover:from-amber-500/25 hover:via-amber-500/10 hover:to-slate-900 disabled:opacity-50",children:[(0,a.jsx)("span",{className:"flex items-center gap-2",children:"\uD83D\uDD14 Faire sonner (20s)"}),!t.online&&(0,a.jsx)("span",{className:"text-[10px] text-amber-100/80",children:"Device hors ligne"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>void b("LOST_MODE"),disabled:null!==s||f,className:"flex items-center justify-between gap-2 rounded-2xl border border-rose-500/80 bg-gradient-to-r from-rose-600/20 via-rose-500/10 to-slate-900 px-4 py-2 text-sm font-semibold text-rose-100 shadow-md shadow-rose-900/40 hover:from-rose-600/30 hover:via-rose-500/15 hover:to-slate-900 disabled:opacity-50",children:[(0,a.jsx)("span",{className:"flex items-center gap-2",children:"\uD83D\uDEA8 Activer mode perdu / vol\xe9"}),(0,a.jsx)("span",{className:"text-[10px] text-rose-100/80",children:"Verrou + message d’alerte"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>void b("LOCK"),disabled:null!==s||f,className:"flex items-center justify-between gap-2 rounded-2xl border border-cyan-500/70 bg-gradient-to-r from-cyan-500/20 via-cyan-500/10 to-slate-900 px-4 py-2 text-sm font-semibold text-cyan-100 shadow-md shadow-cyan-900/40 hover:from-cyan-500/30 hover:via-cyan-500/15 hover:to-slate-900 disabled:opacity-50",children:[(0,a.jsx)("span",{className:"flex items-center gap-2",children:"\uD83D\uDD12 Verrouiller \xe9cran (PIN admin)"}),(0,a.jsx)("span",{className:"text-[10px] text-cyan-100/80",children:"Au prochain heartbeat"})]}),(0,a.jsxs)("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>void b("LOCATION_ONCE"),disabled:null!==s||f,className:"flex items-center justify-center gap-2 rounded-2xl border border-emerald-500/70 bg-emerald-500/10 px-3 py-2 text-[11px] font-semibold text-emerald-100 hover:bg-emerald-500/20 disabled:opacity-50",children:"\uD83C\uDFAF Localiser maintenant"}),(0,a.jsx)("button",{type:"button",onClick:()=>void b("LOCATION_STREAM"),disabled:null!==s||f,className:"flex items-center justify-center gap-2 rounded-2xl border border-indigo-500/70 bg-indigo-500/10 px-3 py-2 text-[11px] font-semibold text-indigo-100 hover:bg-indigo-500/20 disabled:opacity-50",children:"\uD83D\uDCE1 Suivi intensif"})]}),i&&(0,a.jsx)("div",{className:"mt-2 rounded-xl bg-slate-800/80 p-2 text-[11px] text-slate-100",children:i})]}),(0,a.jsxs)("div",{className:"mt-1 rounded-xl border border-slate-800 bg-slate-950/80 px-3 py-2",children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center justify-between text-[11px]",children:[(0,a.jsx)("span",{className:"uppercase tracking-wide text-slate-500",children:"Journal des commandes"}),(0,a.jsx)("span",{className:"text-[10px] text-slate-500",children:"Derni\xe8res actions envoy\xe9es"})]}),0===d.length?(0,a.jsx)("div",{className:"text-[11px] text-slate-500",children:"Aucune commande envoy\xe9e pour cette session."}):(0,a.jsx)("ul",{className:"space-y-1 text-[11px]",children:d.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between rounded-lg bg-slate-900/90 px-2 py-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-slate-100",children:e.label}),(0,a.jsxs)("div",{className:"text-[10px] text-slate-400",children:[e.at,e.details?" • ".concat(e.details):""]})]}),(0,a.jsx)("span",{className:"ml-2 rounded-full px-2 py-0.5 text-[10px] ".concat("OK"===e.status?"bg-emerald-500/15 text-emerald-300":"bg-red-500/20 text-red-200"),children:"OK"===e.status?"OK":"Erreur"})]},e.id))})]})]})}function I(e){let{label:t,value:l,accent:n}=e;return(0,a.jsxs)("div",{className:"rounded-xl border px-3 py-2 text-[11px] shadow-sm ".concat("emerald"===n?"border-emerald-500/60 bg-gradient-to-br from-emerald-500/20 to-slate-950":"border-slate-700 bg-slate-950"),children:[(0,a.jsx)("div",{className:"mb-1 text-[10px] uppercase tracking-wide text-slate-500",children:t}),(0,a.jsx)("div",{className:"text-xs text-slate-100",children:l})]})}},6552:(e,t,l)=>{"use strict";function a(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return a}}),l(5155),l(7650),l(8567),l(7278)},7828:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,l(4054).createAsyncLocalStorage)()},7909:(e,t,l)=>{"use strict";l.d(t,{default:()=>n.a});var a=l(6278),n=l.n(a)},8567:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=l(7828)}}]);