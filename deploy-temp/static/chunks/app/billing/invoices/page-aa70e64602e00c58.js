(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3243],{4168:(e,t,r)=>{Promise.resolve().then(r.bind(r,8309))},8309:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var l,s=r(5155),a=r(2115);let n=null!=(l=r(5704).env.NEXT_PUBLIC_API_BASE_URL)?l:"https://yarmotek-guardcloud-api.myarbanga.workers.dev";function i(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[i,d]=(0,a.useState)(null);return((0,a.useEffect)(()=>{(async()=>{try{var e;l(!0),d(null);let r="".concat(n,"/billing/invoices/by-client?clientId=").concat(encodeURIComponent("CLIENT-TEST")),s=await fetch(r);if(!s.ok)throw Error("HTTP ".concat(s.status.toString()));let a=await s.json();if(!a.ok)throw Error(a.error||"Erreur API");t(null!=(e=a.invoices)?e:[])}catch(e){console.error(e),d(function(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(e){return"Erreur inconnue"}}(e)||"Erreur lors du chargement des factures")}finally{l(!1)}})()},[]),r)?(0,s.jsx)("div",{className:"text-gray-300 px-6 py-4",children:"Chargement des factures…"}):i?(0,s.jsx)("div",{className:"mb-4 rounded-md bg-red-900/60 px-4 py-2 text-sm text-red-200",children:i}):e.length?(0,s.jsxs)("div",{className:"rounded-xl bg-[#050816] border border-gray-800 overflow-hidden",children:[(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-[#060b1a] border-b border-gray-800",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Facture"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Client"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"P\xe9riode"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Appareils"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Montant"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Statut"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Cr\xe9\xe9e le"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left font-medium text-gray-300",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{var t,r;let l=new Date(e.createdAt);return(0,s.jsxs)("tr",{className:"border-t border-gray-800 hover:bg-white/5 transition",children:[(0,s.jsxs)("td",{className:"px-6 py-3 align-middle",children:[(0,s.jsx)("div",{className:"font-semibold",children:e.invoiceId}),e.paidAt&&(0,s.jsxs)("div",{className:"text-xs text-emerald-300",children:["Pay\xe9e le"," ",new Date(e.paidAt).toLocaleDateString("fr-FR")]})]}),(0,s.jsxs)("td",{className:"px-6 py-3 align-middle",children:[(0,s.jsx)("div",{className:"font-semibold",children:null!=(t=e.clientName)?t:e.clientId}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:e.clientId})]}),(0,s.jsx)("td",{className:"px-6 py-3 align-middle",children:"YEARLY"===(r=e.billing.period)?"Ann\xe9e":"WEEKLY"===r?"Semaine":"Mois"}),(0,s.jsx)("td",{className:"px-6 py-3 align-middle",children:e.billing.devicesCount}),(0,s.jsxs)("td",{className:"px-6 py-3 align-middle",children:[(0,s.jsxs)("div",{className:"font-semibold text-emerald-400",children:[e.billing.totalXof.toLocaleString("fr-FR")," XOF"]}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:["≈ ",e.billing.approxUsd.toFixed(2)," USD"]})]}),(0,s.jsx)("td",{className:"px-6 py-3 align-middle",children:function(e){let t=(e||"").toUpperCase();return"PAID"===t?(0,s.jsx)("span",{className:"inline-flex rounded-full bg-emerald-900/80 px-3 py-1 text-xs font-medium text-emerald-200",children:"Pay\xe9e"}):"PENDING"===t?(0,s.jsx)("span",{className:"inline-flex rounded-full bg-amber-900/80 px-3 py-1 text-xs font-medium text-amber-200",children:"En attente"}):(0,s.jsx)("span",{className:"inline-flex rounded-full bg-gray-800 px-3 py-1 text-xs font-medium text-gray-200",children:e||"Inconnu"})}(e.status)}),(0,s.jsx)("td",{className:"px-6 py-3 align-middle",children:l.toLocaleDateString("fr-FR")}),(0,s.jsxs)("td",{className:"px-6 py-3 align-middle space-x-2",children:[(0,s.jsx)("a",{href:e.checkoutUrl,target:"_blank",rel:"noreferrer",className:"inline-block mb-1 rounded-full bg-emerald-500 px-4 py-1 text-xs font-semibold text-black hover:bg-emerald-400",children:"Voir paiement"}),"PAID"===e.status.toUpperCase()&&(0,s.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.invoiceId,void window.open("/api/invoices/".concat(t,"/pdf"),"_blank")},className:"inline-block rounded-full bg-sky-500 px-4 py-1 text-xs font-semibold text-black hover:bg-sky-400",children:"Re\xe7u PDF"})]})]},e.invoiceId)})})]}),(0,s.jsx)("div",{className:"px-6 py-4 text-xs text-gray-400 border-t border-gray-800",children:"Historique des factures g\xe9n\xe9r\xe9es par l'API GuardCloud (MoneyFusion – Fusion Link)."})]}):(0,s.jsx)("div",{className:"px-6 py-4 text-sm text-gray-300",children:"Aucune facture trouv\xe9e pour ce client."})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=4168)),_N_E=e.O()}]);