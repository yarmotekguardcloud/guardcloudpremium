(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7900],{4284:(e,t,s)=>{Promise.resolve().then(s.bind(s,6340))},6340:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var l=s(5155),a=s(2115);function r(){var e,t;let[s,r]=(0,a.useState)("R-0001"),[c,x]=(0,a.useState)(!1),[i,o]=(0,a.useState)(null),[p,u]=(0,a.useState)([]),[m,h]=(0,a.useState)(null),[b,j]=(0,a.useState)(!0),[v,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e,t=!1,l=async()=>{var e,l,a;if(s.trim())try{x(!0),o(null);let a="/api/reseller/tokens?resellerId=".concat(encodeURIComponent(s.trim())),r=await fetch(a,{cache:"no-store"}),n=await r.json();if(!n.ok)throw Error(n.error||"Erreur API reseller/tokens");if(!t){let t=[...null!=(e=n.items)?e:[]].sort((e,t)=>{let s=e=>"ACTIVATED"===e?0:"NEW"===e?1:2;return s(e.status)-s(t.status)});u(t),!v&&t.length>0?f(t[0]):v&&!t.some(e=>e.token===v.token)&&f(null!=(l=t[0])?l:null),h(new Date)}}catch(e){console.error("Erreur chargement tokens revendeur:",e),t||o(null!=(a=null==e?void 0:e.message)?a:"Erreur chargement tokens revendeur")}finally{t||x(!1)}};return l(),b&&(e=window.setInterval(l,15e3)),()=>{t=!0,e&&window.clearInterval(e)}},[s,b,null==v?void 0:v.token]);let g=(0,a.useMemo)(()=>{let e=p.length,t=p.filter(e=>"ACTIVATED"===e.status).length;return{total:e,activated:t,available:p.filter(e=>"NEW"===e.status).length,expired:p.filter(e=>"EXPIRED"===e.status).length}},[p]),N=async e=>{try{if("undefined"==typeof navigator||!navigator.clipboard)return;await navigator.clipboard.writeText(e),alert("Copi\xe9 dans le presse-papiers \uD83D\uDC4D")}catch(e){console.error("Clipboard error:",e)}},y=e=>{if(!e)return"—";try{return new Date(e).toLocaleString()}catch(t){return e}},k=e=>{switch(e){case"NEW":return"Disponible";case"ACTIVATED":return"Activ\xe9";case"EXPIRED":return"Expir\xe9";default:return e}},w=e=>{switch(e){case"NEW":return"bg-emerald-500/10 text-emerald-300 border-emerald-400/60";case"ACTIVATED":return"bg-sky-500/10 text-sky-300 border-sky-400/60";case"EXPIRED":return"bg-rose-500/10 text-rose-300 border-rose-400/60";default:return"bg-slate-700 text-slate-200 border-slate-500/60"}};return(0,l.jsxs)("div",{className:"flex min-h-[calc(100vh-80px)] flex-col gap-4 bg-slate-950/95 px-4 pb-6 pt-4 text-slate-100",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-2xl border border-slate-800 bg-gradient-to-r from-slate-950 via-slate-900 to-slate-950 px-4 py-3 shadow-xl shadow-black/40",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs uppercase tracking-[0.18em] text-slate-500",children:"Yarmotek GuardCloud • Programme Revendeurs"}),(0,l.jsxs)("h1",{className:"mt-1 text-xl font-semibold tracking-tight",children:["Tableau de bord"," ",(0,l.jsx)("span",{className:"text-emerald-400",children:"Licences SahelGuard"})]}),(0,l.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Suivi en temps r\xe9el des licences attribu\xe9es \xe0 chaque revendeur : stock de tokens, licences activ\xe9es, dur\xe9e de validit\xe9 et association client / device."})]}),(0,l.jsxs)("div",{className:"flex flex-col items-end gap-2 text-xs",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("span",{className:"rounded-full bg-slate-900 px-3 py-1 text-[11px]",children:["ID Revendeur\xa0:"," ",(0,l.jsx)("span",{className:"font-semibold text-emerald-400",children:s||"—"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2 rounded-full bg-slate-900 px-3 py-1 text-[11px]",children:[(0,l.jsx)("input",{type:"checkbox",className:"h-3 w-3 rounded border-slate-500 bg-slate-900 text-emerald-500",checked:b,onChange:e=>j(e.target.checked)}),(0,l.jsx)("span",{children:"Refresh auto (15s)"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-[11px] text-slate-500",children:[(0,l.jsx)("span",{className:"inline-flex h-2 w-2 rounded-full ".concat(c?"bg-amber-400":"bg-emerald-400")}),c?"Chargement des licences…":m?"Mis \xe0 jour : ".concat(m.toLocaleTimeString()):"Pr\xeat"]})]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900/80 px-3 py-2 text-xs",children:[(0,l.jsx)("span",{className:"text-[11px] text-slate-400",children:"Changer de revendeur"}),(0,l.jsx)("input",{type:"text",value:s,onChange:e=>r(e.target.value),className:"w-32 rounded-full border border-slate-700 bg-slate-950 px-3 py-1 text-[11px] text-slate-100 placeholder:text-slate-500 focus:border-emerald-400 focus:outline-none",placeholder:"R-0001"}),(0,l.jsx)("button",{type:"button",onClick:()=>{h(null),u([]),f(null)},className:"rounded-full border border-emerald-500/60 bg-emerald-500/10 px-3 py-1 text-[11px] font-medium text-emerald-100 hover:bg-emerald-500/20",children:"Recharger"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs",children:[(0,l.jsx)(n,{label:"Total licences",value:g.total,color:"slate"}),(0,l.jsx)(n,{label:"Disponibles",value:g.available,color:"emerald"}),(0,l.jsx)(n,{label:"Activ\xe9es",value:g.activated,color:"sky"}),(0,l.jsx)(n,{label:"Expir\xe9es",value:g.expired,color:"rose"})]})]}),i&&(0,l.jsx)("div",{className:"rounded-xl border border-rose-700/80 bg-rose-950/70 px-3 py-2 text-xs text-rose-100",children:i}),(0,l.jsxs)("div",{className:"flex min-h-0 flex-1 gap-4",children:[(0,l.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col rounded-2xl border border-slate-800 bg-slate-950/85 p-3 text-xs shadow-[0_18px_40px_rgba(0,0,0,0.75)]",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,l.jsx)("div",{className:"text-[11px] font-semibold uppercase tracking-wide text-slate-400",children:"Licences SahelGuard du revendeur"}),(0,l.jsx)("div",{className:"text-[11px] text-slate-500",children:"Clique sur une ligne pour voir le d\xe9tail complet."})]}),(0,l.jsx)("div",{className:"min-h-0 flex-1 overflow-auto rounded-xl border border-slate-800 bg-slate-950/90",children:(0,l.jsxs)("table",{className:"min-w-full text-left text-[11px]",children:[(0,l.jsx)("thead",{className:"sticky top-0 bg-slate-950/95 backdrop-blur",children:(0,l.jsxs)("tr",{className:"border-b border-slate-800/80 text-[10px] uppercase tracking-wide text-slate-500",children:[(0,l.jsx)("th",{className:"px-3 py-2",children:"Token"}),(0,l.jsx)("th",{className:"px-3 py-2",children:"Statut"}),(0,l.jsx)("th",{className:"px-3 py-2",children:"Client"}),(0,l.jsx)("th",{className:"px-3 py-2",children:"Device"}),(0,l.jsx)("th",{className:"px-3 py-2",children:"Cr\xe9\xe9 le"}),(0,l.jsx)("th",{className:"px-3 py-2",children:"Expiration"})]})}),(0,l.jsxs)("tbody",{children:[0===p.length&&!c&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-3 py-4 text-center text-slate-500",children:"Aucune licence trouv\xe9e pour ce revendeur."})}),p.map(e=>{let t=v&&v.token===e.token;return(0,l.jsxs)("tr",{className:"cursor-pointer border-b border-slate-900/60 transition hover:bg-slate-900/80 ".concat(t?"bg-gradient-to-r from-emerald-500/10 via-slate-900 to-slate-950":""),onClick:()=>f(e),children:[(0,l.jsx)("td",{className:"px-3 py-2 font-mono text-[11px] text-emerald-200",children:e.token}),(0,l.jsx)("td",{className:"px-3 py-2",children:(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] ".concat(w(e.status)),children:[(0,l.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-current"}),k(e.status)]})}),(0,l.jsx)("td",{className:"px-3 py-2 text-slate-200",children:e.clientId?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"font-semibold",children:e.clientId}),e.notes&&(0,l.jsxs)("span",{className:"ml-1 text-[10px] text-slate-500",children:["\xb7 ",e.notes]})]}):(0,l.jsx)("span",{className:"text-slate-500",children:"Non affect\xe9"})}),(0,l.jsx)("td",{className:"px-3 py-2 font-mono text-[10px] text-slate-300",children:e.deviceId||(0,l.jsx)("span",{className:"text-slate-500",children:"—"})}),(0,l.jsx)("td",{className:"px-3 py-2 text-slate-300",children:y(e.createdAt)}),(0,l.jsx)("td",{className:"px-3 py-2 text-slate-300",children:y(e.expiresAt)})]},e.token)})]})]})})]}),(0,l.jsxs)("div",{className:"flex w-[360px] flex-col gap-3 rounded-2xl border border-slate-800 bg-slate-950/85 p-3 text-xs shadow-[0_18px_40px_rgba(0,0,0,0.75)]",children:[!v&&(0,l.jsx)("div",{className:"rounded-xl bg-slate-900/80 p-3 text-slate-400",children:"S\xe9lectionne une licence dans la liste pour voir le d\xe9tail."}),v&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/80 p-3",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:"D\xe9tail licence"}),(0,l.jsx)("div",{className:"font-mono text-[11px] text-emerald-300",children:v.token})]}),(0,l.jsx)("button",{type:"button",className:"rounded-full border border-emerald-500/70 bg-emerald-500/10 px-3 py-1 text-[11px] font-medium text-emerald-100 hover:bg-emerald-500/20",onClick:()=>N(v.token),children:"Copier le token"})]}),(0,l.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[10px] ".concat(w(v.status)),children:[(0,l.jsx)("span",{className:"h-1.5 w-1.5 rounded-full bg-current"}),k(v.status)]}),(0,l.jsxs)("span",{className:"text-[10px] text-slate-400",children:["Dur\xe9e\xa0: ",v.durationDays," jours"]})]})]}),(0,l.jsxs)("div",{className:"space-y-2 rounded-xl border border-slate-800 bg-slate-900/80 p-3",children:[(0,l.jsx)(d,{label:"ID revendeur",value:v.resellerId}),(0,l.jsx)(d,{label:"Client ID",value:null!=(e=v.clientId)?e:"Non affect\xe9"}),(0,l.jsx)(d,{label:"Device ID",value:null!=(t=v.deviceId)?t:"Non li\xe9",mono:!0}),(0,l.jsx)(d,{label:"Cr\xe9\xe9 le",value:y(v.createdAt)}),(0,l.jsx)(d,{label:"Activ\xe9 le",value:y(v.activatedAt)}),(0,l.jsx)(d,{label:"Expire le",value:y(v.expiresAt)}),(0,l.jsx)(d,{label:"Notes",value:v.notes||"—"})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-emerald-700/60 bg-emerald-500/5 p-3 text-[11px] text-emerald-100",children:[(0,l.jsx)("div",{className:"mb-1 font-semibold",children:"Pitch pour le revendeur"}),(0,l.jsxs)("p",{className:"text-[11px] text-emerald-100/90",children:["\xab Chaque token est une licence SahelGuard pr\xeate \xe0 \xeatre vendue. Une fois activ\xe9e sur un t\xe9l\xe9phone, la licence prot\xe8ge le device pendant"," ",(0,l.jsxs)("span",{className:"font-semibold",children:[v.durationDays," jours"]})," ",": localisation temps r\xe9el, g\xe9ofencing, blocage anti-vol et preuves pour la police. \xbb"]})]})]})]})]})]})}function n(e){let{label:t,value:s,color:a}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded-full border px-3 py-1 text-[11px] ".concat({slate:"border-slate-600 bg-slate-900 text-slate-100",emerald:"border-emerald-500/70 bg-emerald-500/10 text-emerald-100",sky:"border-sky-500/70 bg-sky-500/10 text-sky-100",rose:"border-rose-500/70 bg-rose-500/10 text-rose-100"}[a]),children:[(0,l.jsx)("span",{className:"text-[10px] uppercase tracking-wide",children:t}),(0,l.jsx)("span",{className:"text-xs font-semibold",children:s})]})}function d(e){let{label:t,value:s,mono:a}=e;return(0,l.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,l.jsx)("div",{className:"text-[11px] text-slate-500",children:t}),(0,l.jsx)("div",{className:"max-w-[200px] text-right text-[11px] ".concat(a?"font-mono text-slate-100":"text-slate-100"),children:s})]})}}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=4284)),_N_E=e.O()}]);