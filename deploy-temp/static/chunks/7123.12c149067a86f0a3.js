"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7123],{7123:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var a=r(5155),i=r(2115);let s=[12.3657,-1.5339];function l(e){let{devices:t}=e,[l,n]=(0,i.useState)(!1),[c,o]=(0,i.useState)(null);if((0,i.useEffect)(()=>{Promise.all([r.e(1761).then(r.t.bind(r,5027,23)),Promise.all([r.e(1761),r.e(3538)]).then(r.bind(r,3538))]).then(e=>{let[t,r]=e,a=t.default.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});t.default.Marker.prototype.options.icon=a,o({MapContainer:r.MapContainer,TileLayer:r.TileLayer,Marker:r.Marker,Popup:r.Popup,LayersControl:r.LayersControl}),n(!0)})},[]),!l||!c)return(0,a.jsx)("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center text-gray-500",children:"Chargement de la carte..."});let{MapContainer:d,TileLayer:m,Marker:h,Popup:u,LayersControl:p}=c,{BaseLayer:g}=p,x=new Set,f=(t||[]).filter(e=>!x.has(e.deviceId)&&(x.add(e.deviceId),"number"==typeof e.lat&&!Number.isNaN(e.lat)&&"number"==typeof e.lng&&!Number.isNaN(e.lng))),b=s;if(f.length>0){let e=f.reduce((e,t)=>e+t.lat,0),t=f.reduce((e,t)=>e+t.lng,0);b=[e/f.length,t/f.length]}return(0,a.jsxs)(d,{center:b,zoom:12,scrollWheelZoom:!0,className:"w-full h-full",children:[(0,a.jsxs)(p,{position:"topright",children:[(0,a.jsx)(g,{checked:!0,name:"Routier (OSM)",children:(0,a.jsx)(m,{attribution:"\xa9 OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),(0,a.jsx)(g,{name:"Satellite (Esri)",children:(0,a.jsx)(m,{attribution:"Tiles \xa9 Esri",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})})]}),f.map(e=>(0,a.jsx)(h,{position:[e.lat,e.lng],children:(0,a.jsx)(u,{children:(0,a.jsxs)("div",{className:"text-xs leading-tight",children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:e.name}),(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Client\xa0:"})," ",e.clientName||"-"]}),(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Cat\xe9gorie\xa0:"})," ",e.category]}),"number"==typeof e.battery&&(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Batterie\xa0:"})," ",e.battery,"%"," ",(0,a.jsx)("span",{className:"text-[10px] text-gray-500",children:!0===e.charging?"(En charge)":!1===e.charging?"(Sur batterie)":""})]}),e.lastHeartbeat&&(0,a.jsxs)("div",{className:"text-[10px] text-gray-500",children:["Dernier HB\xa0:",new Date(e.lastHeartbeat).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})})},e.deviceId))]})}}}]);